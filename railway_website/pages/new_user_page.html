<!DOCTYPE html>
<html>
    <body>
        <div>
            <h2>New user</h2>
            <form action="" method="POST" onsubmit="return checkInputs()">
                <input type="email" name="new_username" placeholder="Email">
                <input type="password" id='new_password' name="new_password" placeholder="Password">
                <input type="password" id="repeat_password" name="repeat_password" placeholder="Repeat Password">
                <input type="submit" value="login">
                <div>The password requirements:</div>
                <ul>
                    <li>Must be at least 8 characters long</li>
                    <li>Contains one uppercase letter</li>
                    <li>Contains one number</li>
                    <li>Contains one special character</li>
                </ul>
                <a href="/">Back to main page</a>
                
                <script>
                    function checkInputs() {
                        // Get the password and repeat password inputs
                        const newPassword = document.getElementById('new_password').value;
                        const repeatPassword = document.getElementById('repeat_password').value;
                        
                        const isLongEnough = newPassword.length >= 8;
                        const hasUpper = /[A-Z]/.test(newPassword);

                        const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(newPassword);

                        const hasNumber = /\d/.test(newPassword);

                        if (!hasNumber || !hasSpecial || !hasUpper || !isLongEnough) {
                            alert('Password must contain at least one uppercase letter, one number, one special character and be at least 8 characters long');
                            return false;
                        }

                        // Check if the passwords are the same
                        if (newPassword === repeatPassword) {
                        // The passwords are the same, allow the form to be submitted
                        return true;
                        } else {
                        // The passwords are not the same, prevent the form from being submitted
                        alert('The passwords do not match');
                        return false;
                        }
                    }
                </script>
            </form>
        </div>
    </body>
</html>